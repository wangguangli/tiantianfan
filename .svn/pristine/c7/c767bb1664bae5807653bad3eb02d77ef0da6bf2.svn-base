<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
	<title>{:GC('web_title')}管理后台</title>
	<include file="Public/asset_top_page"/>
	<style type="text/css">
		.placeholder {
			margin-bottom: 10px;
		}

		.placeholder img {
			width: 113px;
			height: 113px;
			border: 1px dashed #ccc;
		}

		.spam_check {
			background: #833e4d !important;
		}

		.type_0411 {
			display: flex;
			flex-direction: row;
		}

		.type_0411_1 {
			border: 1px dashed #ccc;
			align-items: center;
			margin-right: 20px;
			padding-right: 23px;
			padding-left: 9px;
			cursor: pointer;
			height: 70px;
			display: flex;
		}

		.type_0411_1:hover {
			background: #fcf5de;
		}

		.type_0411_active {
			background: #fcf5de;
		}

		.type_0411_txt {
			padding-left: 5px;
			font-size: 15px;
		}

		.type_0412 {
			display: flex;
			flex-direction: row;
			border-bottom: 2px solid #e6e9f0;
			position: absolute;
			top: 0;
			left: -130px;
			padding-left: 140px;
			width: 100%;
		}

		.type_0412_1 {
			height: 35px;
			line-height: 35px;
			padding-left: 15px;
			padding-right: 15px;
		}

		.type_0412_active {
			color: #1989fa;
			font-weight: bold;
			border-bottom: 2px solid #1989fa;
		}

		.type_0413 {
			height: 37px;
			border-bottom: 2px solid #e6e9f0;
		}

		.t_two, .t_three, .t_four {
			display: none;
		}
	</style>

</head>
<body>
<!-- header -->
<include file="Public/header"/>
<!-- /header -->
<!-- Page container -->
<div class="page-container">
	<!-- Page content -->
	<div class="page-content">
		<!-- main sidebar -->
		<include file="Public/left"/>
		<!-- /main sidebar -->

		<!-- Main content -->
		<div class="content-wrapper">

			<!-- Content area -->
			<div class="content" style="padding-top: 10px;">
				<!-- Pagination types -->
				<div class="v-container">
					<div class="alert alert-tips alert-dismissible" role="alert">
						<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
								aria-hidden="true">×</span></button>
						在本页添加商品，主要信息必须填写.
					</div>
					<!-- page -->
					<form class="form-horizontal pt-15" method="post" onsubmit="return check();">
						<input type="hidden" class="form-control" name="user_id" value="{$data['id']}">

						<div class="form-group">
							<label class="col-xs-2"></label>
							<div class="col-xs-6 type_0413">
								<div class="type_0412">
									<div class="type_0412_1 type_0412_active" data-num="t_one">
										基本信息
									</div>
									<div class="type_0412_1" data-num="t_two">
										图片信息
									</div>
									<div class="type_0412_1" data-num="t_three">
										价格设置
									</div>
									<div class="type_0412_1" data-num="t_four">
										详情设置
									</div>
								</div>
							</div>
						</div>

						<!--基本信息-->
						<div class="sub_div t_one">
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品名称</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入商品名称" id="name" name="name"
									       value="{$goods.name}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">副标题</label>
								<div class="col-xs-6  control-label">
									<input type="text" class="form-control" placeholder="请输入副标题" id="subhead"
									       name="subhead" value="{$goods.subhead}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品编码</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入商品编码" name="product_code"
									       value="{$goods.product_code}">
								</div>
							</div>
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">本店价格</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入本店价格" id="price"
									       name="price"
									       value="{$goods.price}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">市场价格</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" id="market_price" placeholder="请输入市场价格"
									       name="market_price" value="{$goods.market_price}">
								</div>
							</div>


							<!--商城类型 普通商城还是积分商城							-->
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品类型</label>
								<div class="col-xs-6 ">
									<select name="product_type" class="form-control select-form-control inline-block">
										<option value="0"
										<if condition="$goods['product_type'] eq 0"> selected</if>
										>普通商品</option>
										<option value="1"
										<if condition="$goods['product_type'] eq 1"> selected</if>
										>积分商品</option>
										<option value="2"
										<if condition="$goods['product_type'] eq 2"> selected</if>
										>虚拟商品</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品标记</label>
								<div class="col-xs-6 ">
									<select name="tags_type" class="form-control select-form-control inline-block">
										<option value="0"
										<if condition="$goods['tags_type'] eq 0"> selected</if>
										>新品</option>
										<option value="1"
										<if condition="$goods['tags_type'] eq 1"> selected</if>
										>热销</option>
										<option value="2"
										<if condition="$goods['tags_type'] eq 2"> selected</if>
										>优质</option>

									</select>
								</div>
							</div>


							<div class="form-group">
								<label class="col-xs-2 control-label text-right">特殊分类</label>
								<div class="col-xs-6 ">
									<select name="hot_id" class="form-control select-form-control inline-block"
									        id="hot_id">
										<option value="0">非特殊分类</option>
										<foreach name="show_list" item="vo">
											<option value="{$vo.id}"
											<if condition="$goods['hot_id'] eq $vo['id']"> selected</if>
											>{$vo.name}</option>
										</foreach>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品分类</label>
								<div class="col-xs-6 ">
									<div class="col-xs-4">
										<select name="cat_id_1" class="form-control select-form-control inline-block"
										        onchange="get_category(this.value,'cat_id_2','0');" id="cat_id_1">
											<option value="0">请选择商品分类</option>
											<foreach name="cat_list" item="v" key="k">
												<option value="{$v['id']}"
												<if condition="$v['id'] eq $catinfo['c1']">
													selected="selected"
												</if>
												>
												{$v['name']}</option>
											</foreach>
										</select>
									</div>

									<div class="col-xs-4">
										<select name="cat_id_2" id="cat_id_2" class="form-control"
										        onchange="get_category(this.value,'cat_id_3','0');">
											<option value="0">请选择商品分类</option>
											<foreach name="catinfo['c2list']" item="v2" key="k2">
												<option value="{$v2['id']}"
												<if condition="$v2['id'] eq $catinfo['c2']">
													selected="selected"
												</if>
												>
												{$v2['name']}</option>
											</foreach>
										</select>
									</div>

									<div class="col-xs-4">
										<select name="cat_id_3" id="cat_id_3" class="form-control">
											<option value="0">请选择商品分类</option>
											<foreach name="catinfo['c3list']" item="v3" key="k3">
												<option value="{$v3['id']}"
												<if condition="$v3['id'] eq $catinfo['c3']">
													selected="selected"
												</if>
												>
												{$v3['name']}</option>
											</foreach>
										</select>
									</div>


								</div>
							</div>
							<style>
								.cate_div {
									min-width: 30px;
									height: 30px;
									border: none;
									background: none;
									border: 1px dashed #ccc;
									display: block;
									float: left;
									padding: 3px 5px;
									margin-right: 8px;
									margin-bottom: 8px;
								}
							</style>
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">附属分类(三级分类)</label>
								<div class="col-xs-6 ">
									<div class="cate_list">
										<span class="cate_div ext_cate" cid="c0" id="cate_div">附属分类</span>
										<input type="hidden" value="0" name="extra_cate_list[]" class="cate_ipt"
										       id="cate_ipt">
										<foreach name="extra_cate_list" item="vo">
											<span class="cate_div ext_cate" cid="c{$vo.cate_id}">{$vo.name}</span>
											<input type="hidden" value="{$vo.cate_id}" name="extra_cate_list[]"
											       class="cate_ipt c{$vo.cate_id}">
										</foreach>
									</div>
									<div style="clear: both;">
										<select name="extra_cate_id" class="form-control"
										        onchange="changeCate(this.options[this.options.selectedIndex].value, this.options[this.options.selectedIndex].text);">
											<option value="0">请选择附属分类</option>
											<foreach name="cate3list" item="vo">
												<option value="{$vo['id']}">
													{$vo['name']}
												</option>
											</foreach>
										</select>
									</div>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商家</label>
								<div class="col-xs-6 ">
									<select name="shop_id" class="form-control select-form-control inline-block"
									        id="shop_id">
										<option value="0">平台自营</option>
										<volist name="shop" id="list">
											<option value="{$list.id}"
											<if condition="$goods['shop_id'] eq $list['id']"> selected</if>
											>{$list.shop_name}</option>
										</volist>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">服务费比例</label>
								<div class="col-xs-6 ">
									<select name="shop_fee_id" class="form-control select-form-control inline-block"
									        id="shop_fee_id">
										<option value="0">请选择服务费比例</option>
										<volist name="feelist" id="vo">
											<option value="{$vo.id}"
											<if condition="$goods['shop_fee_id'] eq $vo['id']"> selected</if>
											>平台服务费：{$vo.percent1}%，用户：{$vo.percent2}%，商家：{$vo.percent3}%</option>
										</volist>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品销量</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入商品销量" name="sell_count"
									       value="{$goods.sell_count}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品库存（自动计算）</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入商品库存" name="store_count"
									       value="{$goods.store_count}" readonly>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">排序（值越小越靠前）</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="请输入排序值" name="sort"
									       value="{$goods.sort}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">是否上架</label>
								<div class="col-xs-6 ">
									<select name="is_on_sale" class="form-control select-form-control inline-block">
										<option value="1">上架</option>
										<option value="0">下架</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-xs-2 control-label text-right">商品运费模板</label>
								<div class="col-xs-6 ">
									<select name="shipping_rule_id"
									        class="form-control select-form-control inline-block"
									        id="shipping_rule_id">
										<option value="0">请选择运费模板</option>
										<foreach name="rule_list" item="v" key="k">
											<option value="{$v['id']}"
											<if condition="$v['id'] eq $goods['shipping_rule_id']">
												selected="selected"
											</if>
											>
											{$v['name']}</option>
										</foreach>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">服务列表</label>
								<div class="col-xs-6 ">
									<label class="radio-inline">
										<input type="checkbox" name="service_show1" value="1"
										<if condition="$goods['service_show'][0] eq 1">checked</if>
										>
										7天无理由退货
									</label>
									<label class="radio-inline">
										<input type="checkbox" name="service_show2" value="1"
										<if condition="$goods['service_show'][1] eq 1">checked</if>
										>
										收益获得方式
									</label>
									<label class="radio-inline">
										<input type="checkbox" name="service_show3" value="1"
										<if condition="$goods['service_show'][2] eq 1">checked</if>
										>
										配送方式
									</label>
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">新增属性</label>
								<div class="col-xs-6">
									<label class="radio-inline">
										<input type="checkbox" name="is_group" value="1" class="styled is_group"
										<if condition="$goods['is_group'] eq 1">checked</if>
										>拼团
									</label>
									<label class="radio-inline">
										<input type="checkbox" name="is_hour" value="1" class="styled is_hour"
										<if condition="$goods['is_hour'] eq 1">checked</if>
										>整点秒杀
									</label>
									<label class="radio-inline">
										<input type="checkbox" name="is_time" value="1" class="styled is_time"
										<if condition="$goods['is_time'] eq 1">checked</if>
										>限时购
									</label>
								</div>
							</div>
							<script type="text/javascript">
								$(".is_group").on("click", function () {
									var kv = $(this).val();
									if ($(this).is(':checked')) {
										// 原来没选，现在选择了
										if (kv == 1) {
											// 是否团购
											$(".kind_group").show("normal");
										}
									} else {
										// 原来选择，现在不再选择
										if (kv == 1) {
											$(".kind_group").hide("normal");
										}
									}
								});

								$(".is_hour").on("click", function () {
									var kv = $(this).val();
									if ($(this).is(':checked')) {
										// 原来没选，现在选择了
										if (kv == 1) {
											// 是否整点秒杀
											$(".kind_hour").show("normal");
										}
									} else {
										// 原来选择，现在不再选择
										if (kv == 1) {
											$(".kind_hour").hide("normal");
										}
									}
								});

								$(".is_time").on("click", function () {
									var kv = $(this).val();
									if ($(this).is(':checked')) {
										// 原来没选，现在选择了
										if (kv == 1) {
											// 是否限时购
											$(".kind_time").show("normal");
										}
									} else {
										// 原来选择，现在不再选择
										if (kv == 1) {
											$(".kind_time").hide("normal");
										}
									}
								});

							</script>


							<!--团购设置-->
							<div class="kind_group"
							<if condition="$goods['is_group'] eq 1">style="display: block;"
								<else/>
								style="display: none;"
							</if>
							>
							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>是否开启</label>
								<div class="col-xs-6 ">
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[is_open]" value="1"
										<if condition="$group['is_open'] eq 1">checked</if>
										>
										是
									</label>
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[is_open]" value="0"
										<if condition="$group['is_open'] eq 0">checked</if>
										>
										否
									</label>

								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>发起人是否免费</label>
								<div class="col-xs-6 ">
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[team_leader_free]" value="1"
										<if condition="$group['team_leader_free'] eq 1">checked</if>
										>
										免费
									</label>
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[team_leader_free]" value="0"
										<if condition="$group['team_leader_free'] eq 0">checked</if>
										>
										不免费
									</label>
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[team_leader_free]" value="2"
										<if condition="$group['team_leader_free'] eq 2">checked</if>
										>
										优惠
									</label>

								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>发起人优惠（优惠时）</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="只有上一项选择优惠时，此值才有效"
									       name="group[team_leader_free_money]"
									       value="{$group.team_leader_free_money}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>是否单独购买</label>
								<div class="col-xs-6 ">
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[buy_alone]" value="1"
										<if condition="$group['buy_alone'] eq 1">checked</if>
										>
										是
									</label>
									<label class="radio-inline">
										<input type="radio" class="styled" name="group[buy_alone]" value="0"
										<if condition="$group['buy_alone'] eq 0">checked</if>
										>
										否
									</label>

								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right">（拼团）</b>成团人数</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="一个团需要x人，才算拼团成功，正常发货"
									       name="group[team_people_num]"
									       value="{$group.team_people_num}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>有效成团时间(小时)</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="0 表示无限制"
									       name="group[team_time_limit]"
									       value="{$group.team_time_limit}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>单次购买数量限制</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="0 表示无限制"
									       name="group[team_goods_num]"
									       value="{$group.team_goods_num}">
								</div>
							</div>

							<div class="form-group">
								<label class="col-xs-2 control-label text-right"><b>（拼团）</b>团购商品排序</label>
								<div class="col-xs-6">
									<input type="text" class="form-control" placeholder="0 表示无限制" name="group[sort]"
									       value="{$group.sort}">
								</div>
							</div>
						</div>


						<!-- 整点秒杀设置 -->
						<div class="kind_hour"
						<if condition="$goods['is_hour'] eq 1">style="display: block;"
							<else/>
							style="display: none;"
						</if>
						>

						<div class="form-group">
							<label class="col-xs-2 control-label text-right"><b>（秒杀）</b>开始时间</label>
							<div class="col-xs-6">
								<input type="text" class="form-control" id="start_time_hour" name="hour[start_time]"
								       value="{$hour.start_time}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-2 control-label text-right"><b>（秒杀）</b>结束时间</label>
							<div class="col-xs-6">
								<input type="text" class="form-control" id="end_time_hour" name="hour[end_time]"
								       value="{$hour.end_time}">
							</div>
						</div>
				</div>
				<!-- 秒杀设置 -->

				<!-- 限时购设置 -->
				<div class="kind_time"
				<if condition="$goods['is_time'] eq 1">style="display: block;"
					<else/>
					style="display: none;"
				</if>
				>
				<div class="form-group">
					<label class="col-xs-2 control-label text-right"><b>（限时购）</b>开始时间</label>
					<div class="col-xs-6">
						<input type="text" class="form-control" id="start_time_time" name="time[start_time]"
						       value="{$time.start_time}">
					</div>
				</div>
				<div class="form-group">
					<label class="col-xs-2 control-label text-right"><b>（限时购）</b>结束时间</label>
					<div class="col-xs-6">
						<input type="text" class="form-control" id="end_time_time" name="time[end_time]"
						       value="{$time.end_time}">
					</div>
				</div>
			</div>
			<!-- 限时购设置 -->

			<div class="form-group">
				<label class="col-xs-2 control-label text-right">是否支持自提</label>
				<div class="col-xs-6 ">
					<label class="radio-inline">
						<input type="checkbox" name="is_pick" id="is_pick" value="1"
						<if condition="$goods['is_pick'] eq 1">checked</if>
						>
						商品自提（勾选则开启）
					</label>
				</div>
			</div>
			<script>
				$("#is_pick").on("click", function () {
					var kv = $(this).val();
					if ($(this).is(':checked')) {
						// 原来没选，现在选择了
						if (kv == 1) {
							// 是否限时购
							$(".mention").show("normal");
						}
					} else {
						// 原来选择，现在不再选择
						if (kv == 1) {
							$(".mention").hide("normal");
						}
					}
				});
			</script>


			<!--目前暂时不显示自提点列表  商品全部加入-->
			<div class="form-group" style="display: none;">
				<label class="col-xs-2 control-label text-right"></label>
				<div class="col-xs-6  mention"
				<if condition="$goods['is_pick'] eq 1">style="display: block;"
					<else/>
					style="display: none;"
				</if>
				>
				<volist name="picks" id="vo">
					<div class="form-group" style="margin-left:2.2%">
						<input type="checkbox" name="picksite[]" value="{$vo['id']}"
						<if condition="in_array($vo['id'], $pickHave)"> checked</if>
						> {$vo.title}，{$vo.name} {$vo.phone} ，{$vo.province|get_region_name} {$vo.city|get_region_name}
						{$vo.district|get_region_name} {$vo.address}，{$vo.work_day|get_week_day}
						{$vo.work_time_start}-{$vo.work_time_end}
					</div>
				</volist>
			</div>


		</div>

	</div>

	<!--图片信息-->
	<div class="sub_div t_two">
		<div class="form-group">
			<label class="col-xs-2 control-label text-right">商品封面图片</label>
			<div class="col-xs-6 control-label">
				<div class="placeholder">
					<img src="{$goods_img}" class="img_headimgurl">
				</div>
				<button type="button" class="layui-btn layui-btn-sm" id="upimg">
					<i class="layui-icon">&#xe67c;</i>上传图片
				</button>

				<input type="hidden" name="thumb" id="thumb" class="headimgurl"
				       value="{$goods_img}">
				<span style="color: red">（请上传大于450px的正方形, 非正方形会导致变形,图片大小不能超过3M）</span>

			</div>
		</div>
		<div class="form-group" style="display: none">
			<label class="control-label col-lg-2">商品视频</label>
			<div class="col-lg-6">
				<div class="placeholder">
					<video src="{$goods_video}" class="headvideo" controls="controls"
					       style="width: 50%"></video>
					<!--<img src="" class="img_headimgurl">-->
				</div>

				<button type="button" class="layui-btn " id="upvideo">
					<i class="layui-icon">&#xe67c;</i>上传视频
				</button>
				<span style="color: red">（视频大小不能超过{$size}M）</span>
				<input type="hidden" name="video" class="headvideourl" value="{$goods_video}">

			</div>

		</div>
		<div class="form-group">
			<label class="col-xs-2 control-label text-right">上传商品轮播图片</label>
			<div class="col-xs-6 control-label">
				<div class="placeholder imgapd">
					<img src="{$goods_img2}" class="img_images ">

					<foreach name="goods.images" item="vo2">
						<img src="{$vo2}" class="img_images hover_ext " h="IMG{$key}">
					</foreach>

				</div>
				<button type="button" class="layui-btn layui-btn-sm" id="upimgs">
					<i class="layui-icon">&#xe67c;</i>上传图片（点击图片可删除）
				</button>
				<span style="color: red">（请上传大于450px的正方形, 非正方形会导致变形,图片大小不能超过3M）</span>

				<div class="for_clone">
					<foreach name="goods.images" item="vo2">
						<input type="hidden" name="images[]" class="images img_ipt IMG{$key} "
						       value="{$vo2}">
					</foreach>
				</div>
			</div>
		</div>
	</div>

	<!--价格设置-->
	<div class="sub_div t_three">


		<div class="form-group">
			<label class="col-xs-2 control-label text-right">规格类型</label>
			<div class="col-xs-3 ">
				<select name="type_id" id="type_id"
				        class="form-control select-form-control inline-block">
					<option value="0">请选择规格类型</option>
					<foreach name="type_list" item="v" key="k">
						<option value="{$v['id']}"
						<if condition="$v['id'] eq $goods['type_id']">
							selected="selected"
						</if>
						>
						{$v['name']}</option>
					</foreach>
				</select>
			</div>
			<div class="col-xs-3">
				<div class="col-lg-8">
					<input type="text" name="type_search" class="form-control type_search"
					       placeholder="请输入规格类型名称">
				</div>
				<div class="col-lg-4">
					<a href="javascript:;" class="layui-btn layui-btn-sm layui-btn-normal search_type">查询</a>
					<a href="javascript:;" class="layui-btn layui-btn-sm layui-btn-normal add_type">添加</a>
				</div>
			</div>
		</div>

		<!--规格重新处理 2020.07.28-->
		<div class="form-group">
			<label class="col-xs-2 control-label text-right">商品规格</label>
			<div class="col-xs-6 sku_div">
				<div class="layui-form">
					<div class="sku_wrap">
						<!--这里放置规格列表信息-->
						<div class="sku_3_1" style="display: none;">
							<div class="sku_title">
								<div class="sku_title_left">规格名1：</div>
								<div class="sku_title_right">
									<input list="sku_title_1" onchange="change_sku_1()" type="text" name="sku_title_1"
									       value=""
									       class="form-control sku_ipt" placeholder="请选择规格名">
									<datalist id="sku_title_1">
										<option value="">

									</datalist>
								</div>
							</div>
							<div class="sku_list">
								<div class="sku_list_left">规格值1：</div>
								<div class="sku_list_right sku_list_right_1">

									<!--<input list="sku_list_1" onchange="change_sku_item_1()" type="text"
									       name="sku_list_1" class="form-control"
									       placeholder="请选择规格值">
									<datalist id="sku_list_1">
										<option value="">
									</datalist>-->

								</div>
								<div>
									<a class="add_sub_spec" skunum="1">添加规格值</a>
								</div>
							</div>
						</div>

					</div>
					<div class="add_btn">
						<span class="layui-btn layui-btn-sm layui-btn-primary new_add_spec">添加规格项目</span>
						<input type="hidden" name="spec_id_1" class="spec_id_1" value="0">
						<input type="hidden" name="spec_item_id_1" class="spec_item_id_1" value="0">

					</div>
				</div>
			</div>

		</div>

		<!--规格重新处理 --end  2020.07.28-->

		<div class="form-group">
			<label class="col-xs-2 control-label text-right">活动规格<br>
				<span style="color: #ff3b30;">（若此处<br>规格数量较多<br>建议新增“规格类型”<br>然后在新类型下<br>新建规格）</span>
			</label>
			<div class="col-xs-6">
				<div id="ajax_spec_data"><!-- ajax 返回规格--></div>
				<div id="pesc_price"></div>
			</div>
		</div>
	</div>

	<!--详情设置-->
	<div class="sub_div t_four">
		<div class="form-group">
			<label class="col-xs-2 control-label text-right">商品详情</label>
			<div class="col-xs-6">
				<script id="editor" type="text/plain" style="width:100%;height:400px;" name="content">{$goods.content}

































				</script>
			</div>
		</div>
	</div>

	<input type="hidden" name="goods_id" value="{$goods.id}">

	<div class="form-group">
		<label class="col-xs-2 control-label"></label>
		<div class="col-xs-8">
			<button class="layui-btn layui-btn-sm layui-btn-normal" type="submit">提交</button>
			<a href="javascript:history.go(-1);" class="layui-btn layui-btn-sm layui-btn-primary">返回</a>
		</div>
	</div>
	</form>

	<!-- page end -->

	<!-- Footer -->
	<include file="Public/footer"/>
	<!-- /footer -->

</div>
<!-- /content area -->

</div>
<!-- /main content -->

</div>
<!-- /page content -->

</div>
<!-- /page container -->

<!-- 上传图片 -->
<script>

	layui.use('form', function () {
		var form = layui.form;
	});

	/* 秒杀时间插件 */
	laydate.render({
		elem: '#start_time_hour',
		type: 'datetime'
	});
	laydate.render({
		elem: '#end_time_hour',
		type: 'datetime'
	});
	/* 限时购时间插件 */
	laydate.render({
		elem: '#start_time_time',
		type: 'datetime'
	});
	laydate.render({
		elem: '#end_time_time',
		type: 'datetime'
	});

	var ue = UE.getEditor('editor');
	var goods_id = '{$goods_id}'

	var type_id = '{$type_id}';

	function check() {
		var name = $("#name").val();
		var subhead = $("#subhead").val();
		var thumb = $("#thumb").val();
		var images = $("#images").val();

		var price = $("#price").val();
		var market_price = $("#market_price").val();
		var shop_fee_id = $("#shop_fee_id").val();
		var cat_id_1 = $("#cat_id_1").val();
		var shipping_rule_id = $("#shipping_rule_id").val();
		var type_id = $("#type_id").val();
		if (!name) {
			alert("请填写商品名称");
			return false;
		}
		if (!subhead) {
			alert("请填写商品副标题/简介");
			return false;
		}
		if (thumb == '/Public/images/img_place.png') {
			alert("请上传商品封面图片");
			return false;
		}
		// if (!images) {
		// 	alert("请上传商品轮播图片");
		// 	return false;
		// }
		if (!price) {
			alert("请填写本店价格");
			return false;
		}
		if (!market_price) {
			alert("请填写市场价格");
			return false;
		}
		if (shop_fee_id == 0) {
			// alert("请选择服务费比例");
			// return false;
		}
		if (cat_id_1 == 0) {
			alert("请选择商品分类");
			return false;
		}
		if (shipping_rule_id == 0) {
			alert("请选择商品运费模板");
			return false;
		}
		if (type_id == 0) {
			alert("请选择规格类型");
			return false;
		}
		return true;
	}


	/** 以下 商品规格相关 js*/

	// 商品类型切换时 ajax 调用  返回不同的属性输入框
	$("#type_id").change(function () {

		console.log("---ttt----");
		if ($(this).val() != 0) {
			type_id = $(this).val();
		} else {
			type_id = '{$type_id}';
		}

		console.log("type_id:" + type_id);
		console.log("goods_id:" + goods_id);

		// spec(type_id, goods_id);
		$.ajax({
			type: 'GET',
			data: {goods_id: goods_id, type_id: type_id},
			url: "{:U('Goods/ajax_spec_select')}",
			async: false,
			success: function (data) {
				$("#ajax_spec_data").html('')
				$("#ajax_spec_data").append(data);
				ajaxGetSpecInput();	// 触发完  马上处罚 规格输入框
				$('.add_spec').click(function () {
					index = layer.open({
						type: 2,
						area: ['700px', '450px'],
						fixed: false, //不固定
						maxmin: true,
						content: "{:U('add_spec')}?type_id=" + $(this).attr('data-id')
					});
					console.log(index);
				});
				$('.add_spec_child').click(function () {
					index = layer.open({
						type: 2,
						area: ['700px', '450px'],
						fixed: false, //不固定
						maxmin: true,
						content: "{:U('add_spec')}?spec_id=" + $(this).attr('data-id')
					});
					console.log(index);
				});


				$('img.del').click(function () {
					var id = $(this).attr('data-id');
					layer.confirm('确认要删除该规格项？', {
						btn: ['是的', '取消'] //按钮
					}, function () {

						$.post("{:U('ajax_delete_spec')}", {id: id}, function (res) {

							if (res.status == 1) {
								layer.msg('操作成功!');
								$("#type_id").trigger('change', type_id);
								return;
							}
							layer.msg(res.info);

						}, 'json');
					});
				});
			}
		});
	});
	// 触发商品规格
	var index;
	$("#type_id").trigger('change');

	// 按钮切换 class
	$("#ajax_spec_data").on("click", "span", function () {

		if ($(this).hasClass('spam_check')) {
			$(this).removeClass('spam_check');
		} else {
			$(this).addClass('spam_check');
		}
		ajaxGetSpecInput();
	});

	function ajaxGetSpecInput() {
		//	  var spec_arr = {1:[1,2]};// 用户选择的规格数组
		//	  spec_arr[2] = [3,4]; \

		console.log("-----ajaxGetSpecInput---");

		var spec_arr = {};// 用户选择的规格数组
		var spec_obj = {};
		// 选中了哪些属性
		$("#ajax_spec_data  span.child_span").each(function () {
			if ($(this).hasClass('spam_check')) {
				var tmp = spec_obj[$(this).attr('data-title')];
				if (tmp) {
					tmp.push($(this).attr('data-id'));
					spec_obj[$(this).attr('data-title')] = tmp;
				} else {
					var tmp = new Array();
					tmp.push($(this).attr('data-id'));
					spec_obj[$(this).attr('data-title')] = tmp;
				}
				$(this).removeClass('spam_check');
				$(this).addClass('spam_check')
			}
			for (var k in spec_obj) {
				if (spec_obj[k].length <= 0) {
					delete spec_obj[k];
				}
			}

		});
		console.log("-----ajaxGetSpecInput--2---");
		ajaxGetSpecInput2(spec_obj); // 显示下面的输入框
	}


	/**
	 * 根据用户选择的不同规格选项
	 * 返回 不同的输入框选项
	 */
	function ajaxGetSpecInput2(spec_arr) {

		console.log("-----ajaxGetSpecInput2--1---");
		console.log(spec_arr);

		$.ajax({
			type: 'POST',
			// data:{'spec_arr':spec_arr},
			// url:"/index.php/admin/Goods/ajaxGetSpecInput/goods_id/"+goods_id,
			data: {'spec_arr': JSON.stringify(spec_arr), 'goods_id': goods_id},
			url: "/index.php/admin/Goods/ajaxGetSpecInput",
			success: function (data) {
				console.log("-----spec_data-----");
				console.log(data);

				$("#pesc_price").html('')
				$("#pesc_price").append(data);
				hbdyg(Object.keys(spec_arr).length);  // 合并单元格
			}
		});
	}

	function get_category(id, next, select_id) {

		var url = '/index.php?m=Admin&c=Goods&a=getCategory&parent_id=' + id;
		$.ajax({
			type: "GET",
			url: url,
			error: function (request) {
				alert("服务器繁忙, 请联系管理员!");
				return;
			},
			success: function (v) {
				v = "<option value='0'>请选择商品分类</option>" + v;
				$('#' + next).empty().html(v);
				(select_id > 0) && $('#' + next).val(select_id);//默认选中
			}
		});
	}

	layui.use('upload', function () {
		var upload = layui.upload;

		//执行实例
		var uploadInst = upload.render({

			elem: '#upimg' 							//绑定元素
			, url: '/index.php/Admin/Common/uploads' 	//上传接口
			, data: {handlename: "headimg"}			// 接口接收值
			, field: "headimg"						// input name，与接口接收值 一致
			, done: function (res) {
				//上传完毕回调-不一定成功，需要判断
				console.log(res);
				if (res.status > 0) {
					// 异常提示
					layer.alert(res.result);
				} else {
					$(".headimgurl").val(res.result);
					$(".img_headimgurl").attr("src", res.result);
				}
			}
			, error: function (e) {
				//请求异常回调
				console.log(e);
			}
		});
	});
	layui.use('upload', function () {
		var upload = layui.upload;

		//执行实例
		var uploadInst = upload.render({

			elem: '#upvideo' 							//绑定元素
			, url: '/index.php/Admin/Common/uploads' 	//上传接口
			, data: {handlename: "headimg", video: "1"}			// 接口接收值
			, field: "headimg"						// input name，与接口接收值 一致
			, done: function (res) {

				//上传完毕回调-不一定成功，需要判断
				console.log(res);

				if (res.status > 0) {
					// 异常提示
					layer.alert(res.result);
				} else {
					$(".headvideourl").val(res.result);
					$(".headvideo").attr("src", res.result);
				}
			}
			, error: function (e) {
				//请求异常回调
				console.log(e);
			}
		});
	});

	layui.use('upload', function () {
		var upload = layui.upload;

		//执行实例
		var uploadInst = upload.render({

			elem: '#upimgs' 							//绑定元素
			, url: '/index.php/Admin/Common/uploads' 	//上传接口
			, data: {handlename: "headimg"}			// 接口接收值
			, field: "headimg"						// input name，与接口接收值 一致
			, done: function (res) {
				//上传完毕回调-不一定成功，需要判断
				console.log(res);
				if (res.status > 0) {
					// 异常提示
					layer.alert(res.result);
				} else {
					var tsH = Date.parse(new Date());
					tsH = "IMG" + tsH;

					var iptStr = '<input type="hidden" name="images[]" class="images img_ipt ' + tsH + ' " value="' + res.result + '">';
					$(".for_clone").append(iptStr);
					$(".imgapd").append("<img src=" + res.result + " class='img_images hover_ext' h='" + tsH + "' >");
				}
			}
			, error: function (e) {
				//请求异常回调
				console.log(e);
			}
		});
	});

	// 合并单元格
	function hbdyg(maxCol) {
		var tab = document.getElementById("spec_input_tab"); //要合并的tableID
		var val, count, start;  //maxCol：合并单元格作用到多少列
		if (tab != null) {
			for (var col = maxCol - 1; col >= 0; col--) {
				count = 1;
				val = "";
				for (var i = 0; i < tab.rows.length; i++) {
					if (val == tab.rows[i].cells[col].innerHTML) {
						count++;
					} else {
						if (count > 1) { //合并
							start = i - count;
							tab.rows[start].cells[col].rowSpan = count;
							for (var j = start + 1; j < i; j++) {
								tab.rows[j].cells[col].style.display = "none";
							}
							count = 1;
						}
						val = tab.rows[i].cells[col].innerHTML;
					}
				}
				if (count > 1) { //合并，最后几行相同的情况下
					start = i - count;
					tab.rows[start].cells[col].rowSpan = count;
					for (var j = start + 1; j < i; j++) {
						tab.rows[j].cells[col].style.display = "none";
					}
				}
			}
		}
	}


	$(document).ready(function () {

		$(".imgapd").on("click", ".hover_ext", function () {
			var that = $(this);
			layer.confirm('是否删除此图片?', {icon: 3, title: '提示'}, function (index) {

				var h = that.attr("h");
				console.log(that);
				console.log(h);
				if (h) {
					$(".for_clone").find("." + h).remove();
					that.remove();
				} else {
					layer.msg('删除失败，请尝试刷新');
				}

				layer.close(index);
			});
		});


	});
	$(function () {

		$('form').on("change", ".spec_img_file", function (e) {
			var id = $(this).data("number");
			var formData = new FormData();
			var imgUrl = $('.spec_img' + id).value;
			formData.append("headimg", document.getElementById('spec_img' + id).files[0]);
			formData.append("handlename", 'headimg');
			$.ajax({
				url: '/index.php/Admin/Common/uploads',
				type: 'post',
				data: formData,
				contentType: false,
				dataType: "json",
				processData: false,
				success: function (res, index) {
					console.log(res)
					if (res.status > 0) {
						layer.msg('上传失败');
					} else {
						$('.spec_img' + id).val(res.result);
						$('.spec_' + id).attr("src", res.result)
					}
				},
				error: function () {
					layer.msg('发送失败');
				}
			});
		});

		$(".cate_list").on("click", ".ext_cate", function () {
			var that = $(this);
			var cid = that.attr("cid");
			if (cid == "c0") {
				return true;
			}
			layer.confirm('是否删除此附属分类?', {icon: 3, title: '提示'}, function (index) {

				console.log(that);
				console.log(cid);
				if (cid) {
					$(".cate_list").find("." + cid).remove();
					that.remove();
				} else {
					layer.msg('删除失败，请尝试刷新');
				}

				layer.close(index);
			});
		});

	})

	function changeCate(id, txt) {
		var cate_div = $("#cate_div").clone(true).text(txt).removeAttr("id").attr("cid", "c" + id);
		var cate_ipt = $("#cate_ipt").clone(true).val(id).removeAttr("id").addClass("c" + id);
		$(".cate_list").append(cate_div);
		$(".cate_list").append(cate_ipt);
	}

	$(function () {
		// 规格类型下拉
		$(".search_type").on("click", function () {
			var v = $(".type_search").val();
			$.ajax({
				url: '/index.php/Admin/Goods/searchType',
				type: 'post',
				data: {word: v},
				dataType: "json",
				success: function (res) {
					console.log(res)
					if (res.status > 0) {
						layer.msg('没有相关规格，请重新搜索');
					} else {
						layer.msg('已完成搜索，请查看左侧结果');
						$('#type_id').html(res.result);
					}
				},
				error: function () {
					layer.msg('查询失败，请刷新后重试');
				}
			});

		});

		// 规格类型即时增加
		$(".add_type").on("click", function () {
			var v = $(".type_search").val();
			// addGoodsType
			$.ajax({
				url: '/index.php/Api/Goodsin/addGoodsType',
				type: 'post',
				data: {name: v},
				dataType: "json",
				success: function (res) {
					console.log(res)
					if (res.status > 0) {
						layer.msg(res.msg);
					} else {
						layer.msg(res.msg);
						$('#type_id').html(res.result);
					}
				},
				error: function () {
					layer.msg('添加失败，请刷新后重试');
				}
			});
		});

		// 上方基本信息、图片、规格、详情的切换
		$(".type_0412_1").on("click", function () {
			$(this).addClass("type_0412_active").siblings().removeClass("type_0412_active");
			var dvc = $(this).attr("data-num");
			$("." + dvc).show().siblings(".sub_div").hide();
		});

		// 上方商品类型的选择
		$(".type_0411_1").on("click", function () {
			var hot_id = $(this).attr("data-tn");
			$(this).addClass("type_0411_active").siblings().removeClass("type_0411_active");
			$("input[name=hot_id]").val(hot_id);

			if (hot_id == 1) {
				$('#range').show();
			} else {
				$('#range').hide();
			}
			if (hot_id == 2) {
				$('#express').show();
			} else {
				$('#express').hide();
			}
		});

		// 新添加规格  @zd.220.07.29
		var show_sku_1 = 0;   // 规格1 是否显示，1显示，0不显示
		var show_sku_2 = 0;   // 规格2 是否显示，1显示，0不显示
		var show_sku_3 = 0;   // 规格3 是否显示，1显示，0不显示
		var add_num = 1;
		var shop_id = 0;    // 商家ID
		$(".new_add_spec").on("click", function () {
			if (add_num >= 4) {
				layer.msg("最多只能添加三组规格");
				return false;
			}
			// 查找已经选择哪些规格了
			$(".sku_ipt").each(function (index, ele) {
				var val = $(this).val();
				var spec_id = $(this).attr("spec_id");
			});
			$.ajax({
				type: 'GET',
				data: {spec_id: 0, spec_name: '', shop_id: shop_id, goods_id: goods_id, add_num: add_num},
				url: "{:U('new_spec_list')}",
				async: false,
				dataType: 'json',
				success: function (data) {

					if (data.status == 1) {
						layer.msg(data.msg);
						return false;
					}
					var option_str_spec = "";
					console.log('--data');
					var list = data.result.list;
					var spec_id = data.result.spec_id;
					var itemlist = data.result.itemlist;
					var spec_name = data.result.spec_name;

					for (x in list) {
						var option_res = list[x];
						option_str_spec += "<option value='" + option_res.name + "' spec_id='" + option_res.id + "'>";
					}
					if (show_sku_1 == 0 && add_num == 1) {
						$("#sku_title_1").append(option_str_spec);
					}
					if (add_num == 1) {
						show_sku_1 = 1;
						$(".sku_3_1").show();
					} else if (add_num == 2) {
						show_sku_2 = 1;
						$(".sku_3_2").show();
					} else if (add_num == 3) {
						show_sku_3 = 1;
						$(".sku_3_3").show();
					}
					add_num += 1;
				}
			});
		});
	})


	/*
	 * 添加规格：
	 * 1，规格名，如果只选择，则拿到规格对应的ID，用此ID去查询包含的规格值，并赋值给规格值（后面的添加按钮，也要有作用）
	 * 2，如果规格名不再选择，而是输入的，则先通过接口，把新规格名写入，然后再去选择（或填写）规格值。
	 * 备注：如果规格名 不是选择的，而是输入的新的，则要插入数据库。
	 *      如果规格值 不是选择的，而是输入的新的，则同样要插入数据库。
	 *
	 * */
	var sku_val_1_old = "";     // 旧值
	var sku_item_num_1 = 0;     // 第1个规格值的数量（排序0开始）
	var sku_itemlist_1 = '';    // 第1个规格值列表

	// 规格名切换
	function change_sku_1() {
		console.log('--e--');
		var shop_id = 0;    // 商家ID
		var sku_val_1 = $("input[name=sku_title_1]").val();
		var spec_id = 0;
		var go_to_req = 0;  // 是否去请求，1去请求，0不请求

		if (sku_val_1.length > 0) {
			sku_val_1_old = sku_val_1;
		}
		// 在下拉列表中，找到了对应的值
		$("#sku_title_1 option").each(function (index, ele) {
			var option_value = $(this).val();
			if (sku_val_1 == option_value && sku_val_1.length > 0) {
				spec_id = $(this).attr("spec_id");
				go_to_req = 1;
			}
		});
		// 规格名输入框中有值 ，但是下拉框中找不到，也即新输入的规格名，此时要新增到数据库中
		if (sku_val_1.length > 0 && spec_id == 0) {
			go_to_req = 1;
		}
		// 规格名输入框中为空，也即下拉框中无符合的值
		if (sku_val_1.length < 1 && spec_id < 1) {
			// 什么都没选择，把规格还原
			console.log(sku_val_1_old);
			go_to_req = 0;
			$("input[name=sku_title_1]").val(sku_val_1_old);
		}
		if (go_to_req == 1) {
			$.ajax({
				type: 'GET',
				data: {spec_id: spec_id, spec_name: sku_val_1, shop_id: shop_id, goods_id: goods_id, add_num: 1},
				url: "{:U('new_spec_list')}",
				async: false,
				dataType: 'json',
				success: function (data) {
					if (data.status == 1) {
						layer.msg(data.msg);
						return false;
					}
					var list = data.result.list;
					sku_itemlist_1 = data.result.itemlist;
					var spec_name = data.result.spec_name;
					spec_id = data.result.spec_id;

					var option_str_spec = "";
					for (x in list) {
						var option_res = list[x];
						option_str_spec += "<option value='" + option_res.name + "' spec_id='" + option_res.id + "'>";
					}
					$("#sku_title_1").html(option_str_spec);
					$(".sku_list_right_1").html('');
					var sku_list_html = add_sub_item();
					$(".sku_list_right_1").html(sku_list_html);
				}
			});
		}
		$(".spec_id_1").val(spec_id);
		$(".spec_item_id_1").val(0);
		$("input[name=sku_list_1]").val('');
	}

	// 规格值 切换
	var sku_item_arr_1 = new Array();

	function change_sku_item_1(that) {
		console.log('--change_sku_item_1--');

		var shop_id = 0;    // 商家ID
		var sku_list_1 = that.value; // 规格值输入框中的内容
		var spec_id = $(".spec_id_1").val();                    // 规格名ID
		var spec_item_id = 0;      // 规格值ID
		var go_to_req = 0;  // 是否去请求，1去请求，0不请求
		var clsnum = $(that).attr("clsnum");
		var sku_list_handel = $(that).attr("list");

		if (sku_list_1.length < 1) {
			that.value = $(that).attr("sku_list_1_old");
			return false;
		}
		if (spec_id < 1) {
			layer.msg("请选择规格名");
			$("input[name=sku_list_1]").val("");
			return false;
		}
		// 在下拉列表中，找到了对应的值
		var handle_str = "#" + sku_list_handel + " option";
		console.log('handle_str:' + handle_str);
		$(handle_str).each(function (index, ele) {
			var option_value = $(this).val();
			if (sku_list_1 == option_value && sku_list_1.length > 0) {
				spec_item_id = $(this).attr("spec_item_id");
				go_to_req = 0;
			}
		});
		// 规格值输入框中有值 ，但是下拉框中找不到，也即新输入的规格名，此时要新增到数据库中
		if (sku_list_1.length > 0 && spec_item_id == 0) {
			go_to_req = 1;
		}
		// 规格名输入框中为空，也即下拉框中无符合的值
		if (sku_list_1.length < 1 && spec_item_id < 1) {
			// 什么都没选择
			go_to_req = 0;
		}
		var filter_id = $(".spec_item_id_1").val(); // 已选择的ID
		if (go_to_req == 1) {
			$.ajax({
				type: 'GET',
				data: {spec_id: spec_id, spec_item_name: sku_list_1, shop_id: shop_id, goods_id: goods_id, add_num: 1, filter_id:filter_id},
				url: "{:U('new_spec_item_list')}",
				async: false,
				dataType: 'json',
				success: function (data) {
					if (data.status == 1) {
						layer.msg(data.msg);
						that.value = '';
						return false;
					}
					sku_itemlist_1 = data.result.list;
					var itemlist = data.result.itemlist;
					var spec_name = data.result.spec_name;
					spec_item_id = data.result.spec_item_id;

					var option_str_item = "";
					for (y in itemlist) {
						var option_res = itemlist[y];
						option_str_item += "<option value='" + option_res.item + "' spec_item_id='" + option_res.id + "' spec_id='" + option_res.spec_id + "'>";
					}
					$("." + clsnum).html(option_str_item);
				}
			});
		}

		console.log('spec_item_id:' + spec_item_id);
		$(that).attr("sku_item_1", spec_item_id);
		if (sku_list_1.length > 0) {
			$(that).attr("sku_list_1_old", sku_list_1);
		}
		sku_item_arr_1.push(spec_item_id);
		var sku_item_arr_1_string = sku_item_arr_1.toString();
		$(".spec_item_id_1").val(sku_item_arr_1_string);
		console.log(sku_item_arr_1)
	}

	// 生成规格值的数据内容
	function add_sub_item(skunum) {
		// 规格值 重新处理
		sku_item_num_1 = sku_item_num_1 + 1;  // 先加一下，表示本次的次序
		var sku_list_html = '';
		var sku_item_num_1_class = "sku_item_num_1_" + sku_item_num_1;
		sku_list_html += '<input list="sku_list_1_' + sku_item_num_1 + '" onchange="change_sku_item_1(this)" type="text" name="sku_list_1" class="form-control" clsnum="' + sku_item_num_1_class + '" itnum="' + sku_item_num_1 + '" placeholder="请选择规格值">';

		sku_list_html += '<datalist id="sku_list_1_' + sku_item_num_1 + '" class="' + sku_item_num_1_class + '">';
		sku_list_html += '<option value="">';

		var option_str_item = "";
		for (y in sku_itemlist_1) {
			var option_res = sku_itemlist_1[y];
			var item_index = sku_item_arr_1.indexOf(option_res.id);
			console.log('item_index:' + item_index);
			console.log(sku_item_arr_1);
			console.log(option_res.id);
			if (item_index >= 0) {
				// 已经被选择过了
				console.log('-----1-----');
			} else {
				console.log('-----2-----');
				option_str_item += "<option value='" + option_res.item + "' spec_item_id='" + option_res.id + "' spec_id='" + option_res.spec_id + "'>";
			}
			console.log(option_str_item);
		}
		sku_list_html += option_str_item;
		sku_list_html += '</datalist>';
		return sku_list_html;
	}

	// 添加规格值
	$(".add_sub_spec").on("click", function () {
		var spec_id = $(".spec_id_1").val();                    // 规格名ID
		if (spec_id < 1) {
			layer.msg("请选择规格名");
			$("input[name=sku_list_1]").val("");
			return false;
		}
		var skunum = $(this).attr("skunum");
		var sku_list_html = add_sub_item(skunum);
		$(".sku_list_right_1").append(sku_list_html)
	})


</script>
<!-- 上传图片 -->

</body>
</html>